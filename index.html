<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Countdown 2026</title>
   <style>
    body { 
        /* Efek Galaxy Spiral */
        background: radial-gradient(circle at center, #1a0b2e 0%, #050505 100%);
        background-attachment: fixed;
        color: #00ff41; 
        font-family: 'Courier New', Courier, monospace; 
        display: flex; flex-direction: column; align-items: center; justify-content: center; 
        min-height: 100vh; margin: 0; overflow: hidden;
    }

    /* Efek Cahaya Nebula di Background */
    body::before {
        content: "";
        position: absolute;
        width: 200%; height: 200%;
        background: radial-gradient(circle at 30% 30%, rgba(123, 31, 162, 0.15) 0%, transparent 40%),
                    radial-gradient(circle at 70% 70%, rgba(0, 255, 65, 0.1) 0%, transparent 40%);
        z-index: -1;
        animation: rotateNebula 20s linear infinite;
    }

    @keyframes rotateNebula {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }

    canvas { position: fixed; top: 0; left: 0; z-index: 1; pointer-events: none; }
    #content { z-index: 10; text-align: center; width: 90%; max-width: 600px; }

    h1 { 
        font-size: clamp(2rem, 8vw, 4rem); margin: 0; 
        text-shadow: 0 0 20px rgba(0, 255, 65, 0.6); 
        letter-spacing: 5px; color: #00ff41;
    }

    #timer { 
        font-size: clamp(1rem, 5vw, 2.5rem); color: #fff; 
        margin: 20px 0; font-weight: bold; 
        text-shadow: 0 0 10px rgba(255,255,255,0.5);
    }

    #wish-container { 
        display: none; 
        background: rgba(26, 11, 46, 0.6); /* Transparan Gelap */
        padding: 25px; 
        border: 1px solid rgba(0, 255, 65, 0.5); 
        border-radius: 15px;
        backdrop-filter: blur(10px); /* Efek Kaca Blur */
        box-shadow: 0 0 30px rgba(0, 255, 65, 0.2);
    }

    .input-group { display: flex; gap: 10px; margin-bottom: 20px; }
    
    input { 
        background: rgba(0, 0, 0, 0.5); border: 1px solid #00ff41; 
        color: #fff; padding: 12px; flex-grow: 1; 
        font-family: inherit; outline: none; border-radius: 5px;
    }

    button { 
        background: #00ff41; border: none; padding: 12px 25px; 
        cursor: pointer; font-weight: bold; border-radius: 5px;
        box-shadow: 0 0 15px rgba(0, 255, 65, 0.4);
    }

    #wishList { 
        margin-top: 15px; text-align: left; max-height: 250px; 
        overflow-y: auto; border-top: 1px dashed rgba(0, 255, 65, 0.3); padding-top: 15px; 
    }

    .wish-item { 
        margin-bottom: 10px; font-size: 1rem; color: #e0e0e0; 
        border-left: 3px solid #00ff41; padding-left: 10px; 
    }
</style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="content">
        <h1 id="title">COUNTDOWN 2026</h1>
        <div id="timer">SYNCHRONIZING...</div>
        <div id="wish-container">
            <div id="input-area">
                <div class="input-group">
                    <input type="text" id="wishInput" placeholder="Tulis satu harapanmu untuk 2026..." maxlength="100">
                    <button id="btnKirim">KIRIM</button>
                </div>
            </div>
            <div id="wishList"></div>
        </div>
    </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
    import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-database.js";

    // Konfigurasi Firebase tetap sama
    const firebaseConfig = {
        apiKey: "AIzaSyBxCvCw6F2AJFvkczKHRZAKrk2nOu97BQQ",
        authDomain: "newyear-2025-9f131.firebaseapp.com",
        databaseURL: "https://newyear-2025-9f131-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "newyear-2025-9f131",
        storageBucket: "newyear-2025-9f131.firebasestorage.app",
        messagingSenderId: "259411066922",
        appId: "1:259411066922:web:32533bd3ac15cfd5e90353"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // --- AUTO-YEAR DETECTOR ---
    const targetYear = 2026; // Cukup ganti angka ini saja tiap tahun
    const storageKey = `sent_wish_${targetYear}`; // Key otomatis unik per tahun

    // Tombol Kirim
    const btnKirim = document.getElementById('btnKirim');
    if (btnKirim) {
        btnKirim.addEventListener('click', () => {
            const input = document.getElementById('wishInput');
            const text = input.value.trim();

            if (localStorage.getItem(storageKey)) {
                alert(`Anda sudah mengirimkan harapan untuk tahun ${targetYear}!`);
                return;
            }

            if (text) {
                push(ref(db, `wishes_${targetYear}`), { // Folder database dipisah per tahun
                    text: text,
                    timestamp: Date.now()
                }).then(() => {
                    localStorage.setItem(storageKey, 'true');
                    document.getElementById('input-area').innerHTML = `<p style='color:#00ff41'>Harapan ${targetYear} Anda tersimpan di database.</p>`;
                }).catch(err => alert("Error: " + err.message));
            }
        });
    }

    function loadWishes() {
        if (localStorage.getItem(storageKey)) {
            document.getElementById('input-area').innerHTML = `<p style='color:#00ff41'>Harapan ${targetYear} Anda tersimpan di database.</p>`;
        }
        // Menampilkan pesan sesuai folder tahunnya
        onChildAdded(ref(db, `wishes_${targetYear}`), (snapshot) => {
            const data = snapshot.val();
            const list = document.getElementById('wishList');
            const div = document.createElement('div');
            div.className = 'wish-item';
            div.innerHTML = `<span>></span> ${data.text}`;
            list.prepend(div);
        });
    }

    // Countdown Logic
    const target = new Date(targetYear, 0, 1, 0, 0, 0).getTime();
    const timerUpdate = setInterval(() => {
        const diff = target - new Date().getTime();

        if (diff <= 0) {
            clearInterval(timerUpdate);
            document.getElementById('title').innerText = `HAPPY NEW YEAR ${targetYear}`;
            document.getElementById('timer').style.display = "none";
            document.getElementById('wish-container').style.display = "block";
            loadWishes();
            startFireworks();
        } else {
            const d = Math.floor(diff / 86400000);
            const h = Math.floor((diff % 86400000) / 3600000);
            const m = Math.floor((diff % 3600000) / 60000);
            const s = Math.floor((diff % 60000) / 1000);
            document.getElementById('timer').innerText = `${d}D ${h}H ${m}M ${s}S`;
        }
    }, 1000);

    // --- FIREWORKS TETAP SAMA ---
    // (Gunakan fungsi startFireworks yang sudah ada sebelumnya)
</script>
</body>
</html>




